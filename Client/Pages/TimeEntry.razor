@layout WindowLayoutLayout
@page "/timeentry/{TicketId}"

@attribute [Authorize]

<PageTitle>Time Entry @ticket?.item?.ticketNumber | @company?.CompanyName | @ticket?.item?.title</PageTitle>
<RadzenRow Visible="@(pageLoading)" AlignItems="Radzen.AlignItems.Center" JustifyContent="Radzen.JustifyContent.Center">
    <RadzenStack>
        <RadzenProgressBarCircular Mode="Radzen.ProgressBarMode.Indeterminate" ShowValue="false" Visible="@(pageLoading)" Size="Radzen.ProgressBarCircularSize.Large">

        </RadzenProgressBarCircular>
    </RadzenStack>
</RadzenRow>
<RadzenRow Visible="@(!pageLoading && timeEntryRecord.IsCompleted)" AlignItems="Radzen.AlignItems.Center" JustifyContent="Radzen.JustifyContent.Center">
    <RadzenStack Style="width: 100%" JustifyContent="Radzen.JustifyContent.Center" AlignItems="Radzen.AlignItems.Center" Visible="@timeEntryRecord.IsCompleted">
        <RadzenText Text="Time Entry has been completed.  You may close this window." TextStyle="Radzen.Blazor.TextStyle.H2" />
    </RadzenStack>
</RadzenRow>
<RadzenRow Visible="@(!pageLoading && !timeEntryRecord.IsCompleted)">
    <RadzenColumn SizeXL="9" SizeLG="9" SizeMD="9" SizeSM="8">
       <RadzenStack>
       <RadzenRow AlignItems="Radzen.AlignItems.Center">
            <RadzenColumn SizeLG="6" SizeXL="8" SizeXX="8">
                    <RadzenAlert Variant="Radzen.Variant.Outlined" AlertStyle="Radzen.AlertStyle.Warning" Text="@accountAlertTimeEntry" Title="Account Alert" Visible="@(!string.IsNullOrEmpty(accountAlertTimeEntry))" AllowClose="false"></RadzenAlert>
            </RadzenColumn>
       </RadzenRow>
           
            <RadzenStack Orientation="Radzen.Orientation.Horizontal" AlignItems="Radzen.AlignItems.Center" JustifyContent="Radzen.JustifyContent.SpaceBetween" Wrap="Radzen.FlexWrap.Wrap">
                <RadzenText Text="@($"{ticket?.item?.ticketNumber} - {ticket?.item?.title}")" TextStyle="Radzen.Blazor.TextStyle.H4" />
                <RadzenStack Orientation="Radzen.Orientation.Horizontal" JustifyContent="Radzen.JustifyContent.Right" Style="border: 2px solid var(--rz-primary-lighter); padding-top: 4px; padding: 4px" AlignItems="Radzen.AlignItems.Center">
                    <RadzenText Text="@(ElapsedFormatted)" Style="padding: 4px; border: 2px none #874efe; background-color: #000000" />
                    
                    <RadzenButton Icon="play_arrow" Style="width: 40px" Variant="Radzen.Variant.Outlined" ButtonStyle="Radzen.ButtonStyle.Success" Click="@PlayButtonClick" Visible="@(!timeEntryRecord.TimeStampStatus)" MouseEnter="@PlayButton0MouseEnter" MouseLeave="@PlayButton0MouseLeave"></RadzenButton>
<RadzenButton Icon="pause" Style="width: 40px" Variant="Radzen.Variant.Outlined" Click="@PauseButtonClick" Visible="@(timeEntryRecord.TimeStampStatus)" MouseEnter="@PauseButton1MouseEnter" MouseLeave="@PauseButton1MouseLeave"></RadzenButton>
<RadzenButton Icon="clear" Style="width: 40px" Variant="Radzen.Variant.Outlined" ButtonStyle="Radzen.ButtonStyle.Danger" Click="@ClearTimerButtonClick" MouseEnter="@ClearButton2MouseEnter" MouseLeave="@ClearButton2MouseLeave"></RadzenButton>
                </RadzenStack>
            </RadzenStack>
            
<RadzenStack Orientation="Radzen.Orientation.Horizontal" Wrap="Radzen.FlexWrap.Wrap" AlignItems="Radzen.AlignItems.Center">
    <RadzenStack Orientation="Radzen.Orientation.Horizontal" AlignItems="Radzen.AlignItems.Center" Gap="5">
        <strong>Ticket: </strong>
                <RadzenLink Text="@($"  {timeEntryRecord.TicketNumber}")" Path="@($"https://ww5.autotask.net/Autotask/AutotaskExtend/ExecuteCommand.aspx?Code=OpenTicketDetail&TicketID={ticket.item.id}")" Target="_blank" Icon="captive_portal" MouseEnter="@TicketLink0MouseEnter" MouseLeave="@TicketLink0MouseLeave"></RadzenLink>
                
    </RadzenStack>
    <RadzenStack Orientation="Radzen.Orientation.Horizontal" AlignItems="Radzen.AlignItems.Center" Gap="5">
        <strong>Priority: </strong><RadzenBadge Text="@PriorityName" BadgeStyle="Radzen.BadgeStyle.Danger" IsPill="true" Variant="Radzen.Variant.Filled" Visible="@(PriorityName == "Critical")" Style="padding-left: 10px; padding-right: 10px">
                                               <RadzenStack Style="width: 100%">
                                                   <RadzenText Text="@PriorityName" Style="font-weight: bold" />
                                               </RadzenStack>
                                           </RadzenBadge> 
                                           <RadzenBadge Text="@PriorityName" BadgeStyle="Radzen.BadgeStyle.Warning" IsPill="true" Variant="Radzen.Variant.Filled" Visible="@(PriorityName == "High")" Style="background-color: darkorange; padding-left: 10px; padding-right: 10px">
                                               <RadzenStack Style="width: 100%">
                                                   <RadzenText Text="@PriorityName" Style="font-weight: bold; color: #000000" />
                                               </RadzenStack>
                                           </RadzenBadge>
<RadzenBadge Text="@PriorityName" BadgeStyle="Radzen.BadgeStyle.Success" IsPill="true" Variant="Radzen.Variant.Filled" Visible="@(PriorityName == "Medium")" Style="padding-left: 10px; padding-right: 10px">
                                               <RadzenStack Style="width: 100%">
                                                   <RadzenText Text="@PriorityName" Style="font-weight: bold; color: #000000" />
                                               </RadzenStack>
                                           </RadzenBadge>
<RadzenBadge Text="@PriorityName" BadgeStyle="Radzen.BadgeStyle.Info" IsPill="true" Variant="Radzen.Variant.Filled" Visible="@(PriorityName == "Low")" Style="padding-left: 10px; padding-right: 10px">
                                               <RadzenStack Style="width: 100%">
                                                   <RadzenText Text="@PriorityName" Style="font-weight: bold" />
                                               </RadzenStack>
                                           </RadzenBadge>
<RadzenBadge Text="@PriorityName" BadgeStyle="Radzen.BadgeStyle.Light" IsPill="true" Variant="Radzen.Variant.Filled" Visible="@(PriorityName == "Very Low")" Shade="Radzen.Shade.Lighter" Style="padding-left: 10px; padding-right: 10px">
                                               <RadzenStack Style="width: 100%">
                                                   <RadzenText Text="@PriorityName" Style="font-weight: bold" />
                                               </RadzenStack>
                                           </RadzenBadge>
                                           <RadzenBadge Text="@PriorityName" BadgeStyle="Radzen.BadgeStyle.Light" IsPill="true" Variant="Radzen.Variant.Filled" Visible="@(PriorityName == "Information")" Shade="Radzen.Shade.Lighter" Style="padding-left: 10px; padding-right: 10px">
                                               <RadzenStack Style="width: 100%">
                                                   <RadzenText Text="@PriorityName" Style="font-weight: bold" />
                                               </RadzenStack>
                                           </RadzenBadge>
                                           <RadzenBadge Text="@PriorityName" BadgeStyle="Radzen.BadgeStyle.Danger" IsPill="true" Variant="Radzen.Variant.Filled" Visible="@(PriorityName == "Undetermined")" Shade="Radzen.Shade.Dark" Style="padding-left: 10px; padding-right: 10px">
                                               <RadzenStack Style="width: 100%">
                                                   <RadzenText Text="@PriorityName" Style="font-weight: bold" />
                                               </RadzenStack>
                                           </RadzenBadge>
    </RadzenStack>
    <RadzenStack Orientation="Radzen.Orientation.Horizontal" AlignItems="Radzen.AlignItems.Center" Gap="5">
        <strong>Status: </strong>
                <RadzenBadge Text="@StatusName" BadgeStyle="Radzen.BadgeStyle.Info" IsPill="true" Variant="Radzen.Variant.Filled" Shade="Radzen.Shade.Dark" Style="padding-left: 10px; padding-right: 10px">
                                               <RadzenStack Style="width: 100%">
                                                   <RadzenText Text="@StatusName" Style="font-weight: bold" />
                                               </RadzenStack>
                                           </RadzenBadge>
    </RadzenStack>
    <RadzenStack Orientation="Radzen.Orientation.Horizontal" JustifyContent="Radzen.JustifyContent.Right" AlignItems="Radzen.AlignItems.Center">
        <RadzenText Text="Time Entry Template:" TextStyle="Radzen.Blazor.TextStyle.H4" />
        <RadzenDropDown TValue="int" ValueProperty="TimeEntryTemplateId" TextProperty="Title" Data="@timeEntryTemplates" LoadData="@timeEntryTemplatesLoadData" Count="@timeEntryTemplatesCount" AllowClear="true" Name="TimeEntryTemplate" Change="@TimeEntryTemplateChange"/>
    </RadzenStack>

                
                
                                           
            </RadzenStack>
            <RadzenStack>
                <RadzenTemplateForm TItem="CrownATTime.Server.Models.ATTime.TimeEntry" Data="@timeEntryRecord" Visible="@(timeEntryRecord != null)" Submit="@TemplateForm0Submit" Style="border: 2px solid var(--rz-base); padding: 5px">
                    <RadzenRow style="margin-bottom: 1rem" Visible="@(timeEntryRecord != null)" AlignItems="Radzen.AlignItems.Center">
                        <RadzenColumn SizeMD="3" SizeLG="2">
                            <RadzenLabel Text="Contract" Component="ContractId" style="width: 100%" />
                        </RadzenColumn>
                        <RadzenColumn SizeMD="9" SizeLG="4">
                            <RadzenDropDown TValue="int?" @bind-Value="timeEntryRecord.ContractId" ValueProperty="Id" TextProperty="ContractName" Name="ContractId" Style="width: 100%" Change="@(ContractIdChange)" Data="@contracts"></RadzenDropDown>
                            <RadzenNumericRangeValidator Component="ContractId" Text="Contract is required" Min="1"></RadzenNumericRangeValidator>
                        </RadzenColumn>
                        <RadzenColumn SizeMD="3" SizeLG="2">
                            <RadzenLabel Text="Ticket Status" Component="Status" style="width: 100%" />
                        </RadzenColumn>
                        <RadzenColumn SizeMD="9" SizeLG="4">
                            <RadzenDropDown @bind-Value="@ticket.item.status" Style="width: 100%" TValue="int" Name="status" ValueProperty="ValueInt" TextProperty="Label" Data="@ticketStatuses" Change="@statusChange" AllowFiltering="true" FilterCaseSensitivity="Radzen.FilterCaseSensitivity.CaseInsensitive" ClearSearchAfterSelection="true"></RadzenDropDown>
                            <RadzenNumericRangeValidator Component="status" Text="Ticket Status is required" Min="1"></RadzenNumericRangeValidator>
                        </RadzenColumn>
                    </RadzenRow>
                    <RadzenRow style="margin-bottom: 1rem" AlignItems="Radzen.AlignItems.Center">
                        <RadzenColumn SizeMD="3" SizeLG="2">
                            <RadzenLabel Text="Role" Component="RoleId" style="width: 100%" />
                        </RadzenColumn>
                        <RadzenColumn SizeMD="9" SizeLG="4">
                          <RadzenDropDown TValue="int?" @bind-Value="timeEntryRecord.RoleId" ValueProperty="Id" TextProperty="Name" Name="RoleId" Style="width: 100%" Change="@RoleIdChange" Data="@mappedRoles"></RadzenDropDown>
                          <RadzenNumericRangeValidator Component="RoleId" Text="Role is required" Min="1"></RadzenNumericRangeValidator>
                        </RadzenColumn>
                        <RadzenColumn SizeMD="3" SizeLG="2">
                            <RadzenLabel Text="Billing Code" Component="BillingCodeId" style="width: 100%" />
                            <RadzenBadge Text="Billable" IsPill="true" BadgeStyle="Radzen.BadgeStyle.Danger" Visible="@(!timeEntryRecord.IsNonBillable)"></RadzenBadge>
                        </RadzenColumn>
                        <RadzenColumn SizeMD="9" SizeLG="4">
                            <RadzenDropDown TValue="int?" @bind-Value="timeEntryRecord.BillingCodeId" ValueProperty="Id" TextProperty="Name" Name="BillingCodeId" Style="width: 100%" Change="@(() => BillingCodeIdChange(timeEntryRecord.BillingCodeId.Value))" AllowFiltering="true" FilterCaseSensitivity="Radzen.FilterCaseSensitivity.CaseInsensitive" Data="@billingCodes" ClearSearchAfterSelection="true"></RadzenDropDown>
                          <RadzenNumericRangeValidator Component="BillingCodeId" Text="Billing Code is required" Min="1"></RadzenNumericRangeValidator>
                        </RadzenColumn>
                    </RadzenRow>
                    
                    <RadzenRow style="margin-bottom: 1rem" AlignItems="Radzen.AlignItems.Center">
                        <RadzenColumn SizeMD="3" SizeLG="2">
                            <RadzenLabel Text="Start Date Time" Component="StartDateTime" style="width: 100%" />
                        </RadzenColumn>
                        <RadzenColumn SizeMD="9" SizeLG="4">
                          <RadzenDatePicker style="display: block; width: 100%" @bind-Value="timeEntryRecord.StartDateTime" Name="StartDateTime" ShowTime="true" Kind="System.DateTimeKind.Local" HourFormat="12" Change="@StartDateTimeChange" ReadOnly="true" />
                        </RadzenColumn>
                        <RadzenColumn SizeMD="3" SizeLG="2">
                            <RadzenLabel Text="End Date Time" Component="EndDateTime" style="width: 100%" />
                        </RadzenColumn>
                        <RadzenColumn SizeMD="9" SizeLG="4">
                          <RadzenDatePicker style="display: block; width: 100%" @bind-Value="timeEntryRecord.EndDateTime" Name="EndDateTime" ShowTime="true" Kind="System.DateTimeKind.Local" HourFormat="12" Change="@EndDateTimeChange" ReadOnly="true" />
                        </RadzenColumn>
                    </RadzenRow>
                    
                    <RadzenRow style="margin-bottom: 1rem" AlignItems="Radzen.AlignItems.Center">
                        <RadzenColumn SizeMD="3" SizeLG="2" SizeSM="3">
                            <RadzenLabel Text="Hours Worked" Component="HoursWorked" style="width: 100%" />
                        </RadzenColumn>
                        <RadzenColumn SizeMD="9" SizeLG="4" SizeSM="9">
                          <RadzenNumeric style="display: block; width: 100%" TValue="decimal?" @bind-Value="timeEntryRecord.HoursWorked" Name="HoursWorked" Step=".25" Change="@HoursWorkedChange" Min="0" Format="0.00" ReadOnly="true" AutoCompleteType="Radzen.Blazor.AutoCompleteType.Off" ShowUpDown="false" />
                          <RadzenNumericRangeValidator Text="Hours must be greater than 0.02" Min="0.03" Max="24" Component="HoursWorked"></RadzenNumericRangeValidator>
                        </RadzenColumn>
                        <RadzenColumn SizeMD="3" SizeLG="2" SizeSM="3" Style="text-align: left">
                            <RadzenStack Orientation="Radzen.Orientation.Horizontal" AlignItems="Radzen.AlignItems.Center" JustifyContent="Radzen.JustifyContent.Start">
                                <RadzenLabel Text="Timer Offset" Component="OffsetHours" style="width: 100%" />
                            </RadzenStack>
                        </RadzenColumn>
                        <RadzenColumn SizeMD="9" SizeLG="4" SizeSM="9">
                            <RadzenStack Orientation="Radzen.Orientation.Horizontal" AlignItems="Radzen.AlignItems.Center">
                                <RadzenFormField Text="Hours" Style="width: 100px">
                                    <RadzenNumeric style="display: block" TValue="int" Name="Hours" Value="@Hours" Step="1" Change="@OnHoursChanged" Format="0" AutoCompleteType="Radzen.Blazor.AutoCompleteType.Off" Disabled="@(timeEntryRecord.TimeStampStatus)" Min="-24" Max="24" ShowUpDown="true" />
                                </RadzenFormField>
                                <RadzenFormField Text="Minutes" Style="width: 100px">
                                    <RadzenNumeric style="display: block" TValue="int" Name="Minutes" Value="@Minutes" Step="1" Change="@OnMinutesChanged" Format="0" AutoCompleteType="Radzen.Blazor.AutoCompleteType.Off" Disabled="@(timeEntryRecord.TimeStampStatus)" Min="-59" Max="59" />
                                </RadzenFormField>
                                <RadzenButton ButtonStyle="Radzen.ButtonStyle.Success" Variant="Radzen.Variant.Outlined" Size="Radzen.ButtonSize.Small" Disabled="@(timeEntryRecord.TimeStampStatus)" Click="@TimerOffsetButtonClick" Text="Save" Style="width: 80px" Icon="timer" MouseEnter="@UpdateTimerButton6MouseEnter" MouseLeave="@UpdateTimerButton6MouseLeave"></RadzenButton>
                            </RadzenStack>
                        </RadzenColumn>
                    </RadzenRow>
                    <RadzenRow style="margin-bottom: 1rem" AlignItems="Radzen.AlignItems.Center">
                    
                        <RadzenColumn SizeMD="3">
                            <RadzenLabel Text="Is Non Billable?" Component="IsNonBillable" style="width: 100%" />
                            <RadzenCheckBox @bind-Value="timeEntryRecord.IsNonBillable" Name="IsNonBillable" TValue="bool" Change="@IsNonBillableChange" />

                        </RadzenColumn>
                        
                        <RadzenColumn SizeMD="3">
                            <RadzenLabel Text="Show On Invoice?" Component="ShowOnInvoice" style="width: 100%" />
                            <RadzenCheckBox @bind-Value="timeEntryRecord.ShowOnInvoice" Name="ShowOnInvoice" TValue="bool" Change="@ShowOnInvoiceChange" />

                        </RadzenColumn>
                       
                    </RadzenRow>
                    
                    <RadzenRow style="margin-bottom: 1rem">
                        <RadzenColumn SizeMD="6">
                            <RadzenRow style="margin-bottom: 1rem" AlignItems="Radzen.AlignItems.Center">
                                <RadzenLabel Text="Summary Notes" Component="SummaryNotes">
                                </RadzenLabel>
                                <RadzenButton Size="Radzen.ButtonSize.ExtraSmall" Icon="more_time" Variant="Radzen.Variant.Outlined" Click="@InsertTimeSummaryNotesButtonClick" MouseEnter="@SummaryNoteButton4MouseEnter" MouseLeave="@SummaryNoteButton4MouseLeave"></RadzenButton>
                            </RadzenRow>
                            <RadzenRow style="margin-bottom: 1rem" AlignItems="Radzen.AlignItems.Center">
                                <RadzenTextArea @bind-Value="timeEntryRecord.SummaryNotes" Name="SummaryNotes" Style="width: 100%" Rows="10" Change="SummaryNotesChange"></RadzenTextArea>
                            <RadzenRequiredValidator Component="SummaryNotes"></RadzenRequiredValidator>

                            </RadzenRow>
                        </RadzenColumn>
                        <RadzenColumn SizeMD="6">
                            <RadzenRow style="margin-bottom: 1rem" AlignItems="Radzen.AlignItems.Center">
                                    <RadzenLabel Text="Internal Notes" Component="InternalNotes" style="color: var(--rz-danger)" />
                                    <RadzenButton Size="Radzen.ButtonSize.ExtraSmall" Icon="more_time" Variant="Radzen.Variant.Outlined" Click="@InsertTimeInternalNotesButtonClick" MouseEnter="@InternalNotesButton5MouseEnter" MouseLeave="@InternalNotesButton5MouseLeave"></RadzenButton>
                            </RadzenRow>
                            <RadzenRow style="margin-bottom: 1rem" AlignItems="Radzen.AlignItems.Center">
                                <RadzenTextArea @bind-Value="@timeEntryRecord.InternalNotes" Name="InternalNotes" Style="width: 100%" Rows="10" Change="InternalNotesChange"></RadzenTextArea>
                            </RadzenRow>
                        </RadzenColumn>

                        
                        
                        
                    </RadzenRow>
                    <RadzenRow Gap="">
                 
                        <RadzenAccordion Style="margin-bottom: 10px" Multiple="true">
                            <Items>
                                <RadzenAccordionItem Expanded="True" Text="Checklist Items" Style="width: 100%" Icon="playlist_add_check" Selected="true">
                                    <ChecklistItems TicketId="@(Convert.ToInt32(ticket.item.id))" ResourceId="@(Convert.ToInt32(resource.Id))" />

                                </RadzenAccordionItem>
                            </Items>
                        </RadzenAccordion>
                    </RadzenRow>
                    <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" JustifyContent="JustifyContent.End" Wrap="Radzen.FlexWrap.Wrap">
                        <RadzenStack SizeMD="3" Orientation="Radzen.Orientation.Horizontal" AlignItems="Radzen.AlignItems.Center">
                            <RadzenLabel Text="Append To Resolution?" Component="AppendToResolution" style="width: 100%" />
                            <RadzenCheckBox @bind-Value="@appendToResolution" TValue="bool" Name="AppendToResolution" />
                        </RadzenStack>
                            <RadzenButton ButtonStyle="Radzen.ButtonStyle.Primary" ButtonType="ButtonType.Submit" Icon="save" Text="Complete Time Entry" Variant="Radzen.Variant.Outlined" IsBusy="isSaving" BusyText="Completing Time Entry" Shade="Radzen.Shade.Default" MouseEnter="@CompleteTimeEntryButton6MouseEnter" MouseLeave="@CompleteTimeEntryButton6MouseLeave"/>
                        <RadzenButton ButtonStyle="Radzen.ButtonStyle.Primary" ButtonType="ButtonType.Submit" Icon="confirmation_number" Text="Save & Close Ticket" Variant="Radzen.Variant.Outlined" Click="@SaveAndCloseTicketButtonClick" IsBusy="isSaving" BusyText="Completing & Closing Ticket" Shade="Radzen.Shade.Default" MouseEnter="@CloseTicketButton7MouseEnter" MouseLeave="@CloseTicketButton7MouseLeave" />
                        <RadzenButton ButtonStyle="Radzen.ButtonStyle.Danger" ButtonType="ButtonType.Button" Icon="delete" Text="Delete" Variant="Radzen.Variant.Outlined" Shade="Radzen.Shade.Default" Click="@DeleteTimeEntryButtonClick" MouseEnter="@DeleteTimeEntryButton8MouseEnter" MouseLeave="@DeleteTimeEntryButton8MouseLeave" />
                    </RadzenStack>
                </RadzenTemplateForm>
            
            </RadzenStack>
       </RadzenStack>
    </RadzenColumn>
    <RadzenColumn SizeXL="3" SizeLG="3" SizeMD="3" SizeSM="4">
    <RadzenStack>
        <RadzenFieldset Text="Email & Notes" AllowCollapse="true" Icon="email">
                        <RadzenStack Orientation="Radzen.Orientation.Horizontal" Gap="5" Wrap="Radzen.FlexWrap.Wrap">
                            <RadzenButton Variant="Radzen.Variant.Outlined" Size="Radzen.ButtonSize.ExtraSmall" Icon="email" Text="Send Email" Click="@SendEmailButtonClick"></RadzenButton>
                            <RadzenButton Variant="Radzen.Variant.Outlined" Size="Radzen.ButtonSize.ExtraSmall" Icon="note" Text="Add Note" Click="@AddNoteButtonClick" Visible="true"></RadzenButton>
                        </RadzenStack>

                    </RadzenFieldset>
                    <RadzenFieldset Text="@($"RMM Device {configurationItem?.item?.referenceTitle}")" AllowCollapse="true" Icon="computer" Visible="@ticket.item.configurationItemID.HasValue">
                        <RadzenStack Orientation="Radzen.Orientation.Horizontal" Gap="5" Wrap="Radzen.FlexWrap.Wrap">
                            <RadzenButton Variant="Radzen.Variant.Outlined" Size="Radzen.ButtonSize.ExtraSmall" Icon="computer" Text="Device" Click="@DeviceButtonClick"></RadzenButton>
                            <RadzenButton Variant="Radzen.Variant.Outlined" Size="Radzen.ButtonSize.ExtraSmall" Icon="connected_tv" Text="Web Remote" Click="@WebRemoteButtonClick"></RadzenButton>
                            <RadzenButton Variant="Radzen.Variant.Outlined" Size="Radzen.ButtonSize.ExtraSmall" Icon="connected_tv" Text="Agent Browser" Click="@AgentBrowserButtonClick"></RadzenButton>
                            <RadzenButton Variant="Radzen.Variant.Outlined" Size="Radzen.ButtonSize.ExtraSmall" Icon="connected_tv" Text="Splashtop" Click="@SplashtopButtonClick"></RadzenButton>
                            <RadzenButton Variant="Radzen.Variant.Outlined" Size="Radzen.ButtonSize.ExtraSmall" Icon="connected_tv" Text="ScreenConnect" Click="@ScreenConnectButtonClick"></RadzenButton>
                        </RadzenStack>

                    </RadzenFieldset>
                    <RadzenFieldset Text="Contact Details" AllowCollapse="true" Icon="person" Collapsed="false" Visible="@ticket.item.contactID.HasValue">
                    <RadzenStack Gap="10">

                        <RadzenStack Orientation="Radzen.Orientation.Vertical" Gap="5" Wrap="Radzen.FlexWrap.Wrap">
                                <RadzenLink Text="@($"  {contact?.item.fullName}")" Path="@($"https://ww5.autotask.net/Autotask/AutotaskExtend/ExecuteCommand.aspx?Code=OpenContact&ContactID={ticket?.item?.contactID}")" Target="_blank" Style="font-weight: bold" Icon="captive_portal" MouseEnter="@ContactLink1MouseEnter" MouseLeave="@ContactLink1MouseLeave"></RadzenLink>

                        </RadzenStack>
<RadzenStack Orientation="Radzen.Orientation.Vertical" Gap="5" Wrap="Radzen.FlexWrap.Wrap">
                            <RadzenText Text="Phone Numbers:" Style="font-weight: bold; color: var(--rz-info-light)" />
                            <RadzenStack Orientation="Radzen.Orientation.Horizontal" Gap="5" Wrap="Radzen.FlexWrap.Wrap" AlignItems="Radzen.AlignItems.Center">
                                <RadzenButton Size="Radzen.ButtonSize.ExtraSmall" Icon="call" Visible="@(!string.IsNullOrEmpty(company?.Phone))" Click="@CallContactPhoneButtonClick" Variant="Radzen.Variant.Outlined" Style="width: 24px; height: 24px"></RadzenButton>
                                <RadzenText Text="@($"{contact?.item.phone} Ext: {contact?.item.extension}")" Visible="@(company != null)" />

                            </RadzenStack>
<RadzenStack Orientation="Radzen.Orientation.Horizontal" Gap="5" Wrap="Radzen.FlexWrap.Wrap" AlignItems="Radzen.AlignItems.Center">
                                <RadzenButton Size="Radzen.ButtonSize.ExtraSmall" Icon="phonelink_ring" Visible="@(!string.IsNullOrEmpty(company?.Phone))" Click="@CallContactPhoneButtonClick" Variant="Radzen.Variant.Outlined" Style="width: 24px; height: 24px"></RadzenButton>
                                <RadzenText Text="@($"{contact?.item.mobilePhone}")" Visible="@(company != null)" />

                            </RadzenStack>
<RadzenStack Orientation="Radzen.Orientation.Horizontal" Gap="5" Wrap="Radzen.FlexWrap.Wrap" AlignItems="Radzen.AlignItems.Center">
    <RadzenButton Size="Radzen.ButtonSize.ExtraSmall" Icon="call" Click="@CallOtherNumberButtonClick" Variant="Radzen.Variant.Outlined" Style="width: 24px; height: 24px"></RadzenButton>
    <RadzenFormField Component="OtherNumber" Text="Other Number">
        <RadzenTextBox AutoCompleteType="Radzen.Blazor.AutoCompleteType.Off" @bind-Value="@OtherNumber" Name="OtherNumber" Placeholder="Enter any other number to call" Change="@OtherNumberChange" Style="width: 155px"></RadzenTextBox>
    </RadzenFormField>

</RadzenStack>
                        </RadzenStack>

                    </RadzenStack>
                    </RadzenFieldset>
<RadzenFieldset Text="Company Details" AllowCollapse="true" Icon="domain" Collapsed="false">
                    <RadzenStack Gap="10">

                        <RadzenStack Orientation="Radzen.Orientation.Vertical" Gap="5" Wrap="Radzen.FlexWrap.Wrap">
                                <RadzenLink Text="@($"  {company?.CompanyName}")" Path="@($"https://ww5.autotask.net/Autotask/AutotaskExtend/ExecuteCommand.aspx?Code=OpenAccount&AccountID={ticket.item.companyID}")" Target="_blank" Style="font-weight: bold; text-align: left" Icon="captive_portal" MouseEnter="@CompanyLink2MouseEnter" MouseLeave="@CompanyLink2MouseLeave"></RadzenLink>

                        </RadzenStack>
<RadzenStack Orientation="Radzen.Orientation.Vertical" Gap="1" Wrap="Radzen.FlexWrap.Wrap">
                            <RadzenText Text="Phone Numbers:" Style="font-weight: bold; color: var(--rz-info-light)" />
                            <RadzenStack Orientation="Radzen.Orientation.Horizontal" Gap="5" Wrap="Radzen.FlexWrap.Wrap" AlignItems="Radzen.AlignItems.Center">
                                <RadzenButton Size="Radzen.ButtonSize.ExtraSmall" Icon="call" Visible="@(!string.IsNullOrEmpty(company?.Phone))" Click="@CallCompanyPhoneButtonClick" Variant="Radzen.Variant.Outlined" Style="width: 24px; height: 24px"></RadzenButton>
                                <RadzenText Text="@($"{company?.Phone}")" Visible="@(company != null)" />

                            </RadzenStack>
                            <RadzenStack Orientation="Radzen.Orientation.Horizontal" Gap="5" Wrap="Radzen.FlexWrap.Wrap" AlignItems="Radzen.AlignItems.Center">
                                <RadzenButton Size="Radzen.ButtonSize.ExtraSmall" Icon="call" Click="@CallOtherNumberButtonClick" Variant="Radzen.Variant.Outlined" Style="width: 24px; height: 24px"></RadzenButton>
                                <RadzenFormField Component="OtherNumber" Text="Other Number">
                                    <RadzenTextBox AutoCompleteType="Radzen.Blazor.AutoCompleteType.Off" @bind-Value="@OtherNumber" Name="OtherNumber" Placeholder="Enter any other number to call" Change="@OtherNumberChange" Style="width: 155px"></RadzenTextBox>
                                </RadzenFormField>
                            
                            </RadzenStack>
                        </RadzenStack>
<RadzenStack Orientation="Radzen.Orientation.Vertical" Gap="1" Wrap="Radzen.FlexWrap.Wrap">
                            <RadzenText Text="Company Address:" Style="font-weight: bold; color: var(--rz-info-light)" />

                            <RadzenText Text="@($"{company?.Address1}, {(!string.IsNullOrEmpty(company?.Address2) ? company?.Address2 + ", " : "")}{company?.City}, {company?.State} {company?.PostalCode}")" Visible="@(company != null)" />
                        </RadzenStack>
<RadzenStack Orientation="Radzen.Orientation.Vertical" Gap="1" Wrap="Radzen.FlexWrap.Wrap" Visible="@(companyLocation != null)">
                            <RadzenText Text="Ticket Location:" Style="font-weight: bold; color: var(--rz-info-light)" />
<RadzenText Text="@companyLocation?.item?.name" Style="font-weight: bold" />

                            <RadzenText Text="@($"{companyLocation?.item?.address1}, {(!string.IsNullOrEmpty(companyLocation?.item?.address2) ? companyLocation?.item?.address2 + ", " : "")}{companyLocation?.item?.city}, {companyLocation?.item?.state} {companyLocation?.item?.postalCode}")" Visible="@(company != null)" />
                        </RadzenStack>

                    </RadzenStack>
                    </RadzenFieldset>
                    <RadzenFieldset Text="Rocketship" AllowCollapse="true" Icon="rocket_launch">
                    <iframe class="responsive-iframe" src="@(rocketshipUrl)"></iframe>

                    </RadzenFieldset>
    </RadzenStack>
        @* <RadzenAccordion Style="width: 100%" Multiple="true" @bind-SelectedIndex="@accordionSelectedIndex">
            <Items>
                <RadzenAccordionItem Text="Insights"  Icon="visibility" Selected="true" >
                    
                
                </RadzenAccordionItem>
                <RadzenAccordionItem Text="Rocketship" Icon="rocket_launch" >
                </RadzenAccordionItem>
            </Items>

        </RadzenAccordion> *@
        
    </RadzenColumn>
</RadzenRow>
<style><RadzenButton Variant="Radzen.Variant.Outlined" Size="Radzen.ButtonSize.Small" Icon="computer" Text="Device"></RadzenButton>

    .responsive-iframe {
      /* position: absolute; */
      top: 0;
      left: 0;
      bottom: 0;
      right: 0;
      width: 100%;
      height: 65vh;
      border: none;
    }
</style>